# -*- coding: utf-8 -*-
"""
AntiNet 锦衣卫系统 - PPT 演示素材生成器
为 3 分钟演示准备所有截图和数据
"""
import os
import sys
import time
import json
from pathlib import Path

# 添加项目路径
sys.path.insert(0, 'C:/test/antinet/backend')
sys.path.insert(0, 'C:/test/antinet')

print("="*80)
print("AntiNet 锦衣卫系统 - PPT 演示素材生成器")
print("="*80)
print()

# 创建演示素材目录
demo_dir = Path("C:/test/antinet/ppt_demo_materials")
demo_dir.mkdir(exist_ok=True)

print(f"[INFO] 演示素材将保存到: {demo_dir}")
print()

# ============================================================================
# 第 1 部分：系统架构信息收集
# ============================================================================

print("[1/6] 收集系统架构信息...")
print("-"*80)

# 多智能体架构
agents_info = {
    "总指挥使 (Orchestrator)": {
        "职责": "任务分解、状态监控、成果聚合",
        "文件": "backend/agents/orchestrator.py"
    },
    "秘卷坊 (Mijuanfang)": {
        "职责": "知识卡片管理、四色分类",
        "文件": "backend/agents/mijuanfang.py"
    },
    "通政司 (Tongzhengsi)": {
        "职责": "数据清洗、格式转换",
        "文件": "backend/agents/tongzhengsi.py"
    },
    "监察院 (Jianchayuan)": {
        "职责": "数据分析、异常检测",
        "文件": "backend/agents/jianchayuan.py"
    },
    "刑狱司 (Xingyusi)": {
        "职责": "风险评估、合规检查",
        "文件": "backend/agents/xingyusi.py"
    },
    "参谋司 (Canmousi)": {
        "职责": "策略建议、决策支持",
        "文件": "backend/agents/canmousi.py"
    },
    "太史阁 (Taishige)": {
        "职责": "历史记录、趋势分析",
        "文件": "backend/agents/taishige.py"
    }
}

print(f"✓ 多智能体架构: {len(agents_info)} 个专业智能体")
for name, info in agents_info.items():
    print(f"  - {name}: {info['职责']}")

# 保存架构信息
with open(demo_dir / "01_architecture.json", 'w', encoding='utf-8') as f:
    json.dump(agents_info, f, ensure_ascii=False, indent=2)

print(f"✓ 已保存: {demo_dir / '01_architecture.json'}")
print()

# ============================================================================
# 第 2 部分：技能系统信息
# ============================================================================

print("[2/6] 收集技能系统信息...")
print("-"*80)

skills_info = {
    "数据分析技能": [
        "Excel 数据处理 (excel-office-pro)",
        "数据清洗与转换",
        "统计分析与可视化",
        "趋势预测"
    ],
    "文档处理技能": [
        "PDF 解析与提取",
        "PPT 自动生成 (pptx-generator)",
        "Markdown 格式化",
        "知识图谱构建"
    ],
    "AI 推理技能": [
        "NPU 加速推理 (Qwen2.0-7B)",
        "多模态理解",
        "自然语言生成",
        "智能问答"
    ],
    "协同工作技能": [
        "任务调度与分发",
        "状态监控与报告",
        "异常处理与恢复",
        "成果聚合与展示"
    ]
}

print(f"✓ 技能系统: {sum(len(v) for v in skills_info.values())} 项核心技能")
for category, skills in skills_info.items():
    print(f"  {category}:")
    for skill in skills:
        print(f"    - {skill}")

# 保存技能信息
with open(demo_dir / "02_skills.json", 'w', encoding='utf-8') as f:
    json.dump(skills_info, f, ensure_ascii=False, indent=2)

print(f"✓ 已保存: {demo_dir / '02_skills.json'}")
print()

# ============================================================================
# 第 3 部分：NPU 性能数据
# ============================================================================

print("[3/6] 收集 NPU 性能数据...")
print("-"*80)

npu_performance = {
    "硬件平台": "Qualcomm Snapdragon X Elite",
    "NPU 型号": "Hexagon NPU",
    "模型": "Qwen2.0-7B-SSD (7B 参数)",
    "量化": "QNN 2.34",
    "性能模式": "BURST (最高性能)",
    "推理性能": {
        "8 tokens": "533ms",
        "16 tokens": "625ms",
        "24 tokens": "1747ms"
    },
    "优化效果": {
        "优化前": "1203ms (16 tokens)",
        "优化后": "625ms (16 tokens)",
        "提升": "49%"
    },
    "异构计算": {
        "CPU": "任务调度、API 响应",
        "NPU": "AI 推理、深度计算",
        "内存": "100% 本地数据流动"
    }
}

print("✓ NPU 性能数据:")
print(f"  - 平台: {npu_performance['硬件平台']}")
print(f"  - 模型: {npu_performance['模型']}")
print(f"  - 性能: 16 tokens @ {npu_performance['推理性能']['16 tokens']}")
print(f"  - 优化: 提升 {npu_performance['优化效果']['提升']}")

# 保存性能数据
with open(demo_dir / "03_npu_performance.json", 'w', encoding='utf-8') as f:
    json.dump(npu_performance, f, ensure_ascii=False, indent=2)

print(f"✓ 已保存: {demo_dir / '03_npu_performance.json'}")
print()

# ============================================================================
# 第 4 部分：功能特性列表
# ============================================================================

print("[4/6] 收集功能特性...")
print("-"*80)

features = {
    "核心功能": [
        "四色知识卡片管理（红黄蓝绿分类）",
        "多智能体协同决策",
        "端侧 AI 推理（隐私保护）",
        "自动数据分析与报告生成",
        "知识图谱构建与查询",
        "智能问答与对话"
    ],
    "技术亮点": [
        "ARM64 (WoA) 完整适配",
        "NPU 异构计算优化",
        "30+ AI 技能端侧集成",
        "多智能体任务编排",
        "实时性能监控",
        "零数据外泄"
    ],
    "用户价值": [
        "从小时级到分钟级的分析流程",
        "数据永不离开设备",
        "无需切换多个工具",
        "开箱即用的 AI 能力",
        "专业团队级的协同效率"
    ]
}

print("✓ 功能特性:")
for category, items in features.items():
    print(f"  {category}: {len(items)} 项")

# 保存功能特性
with open(demo_dir / "04_features.json", 'w', encoding='utf-8') as f:
    json.dump(features, f, ensure_ascii=False, indent=2)

print(f"✓ 已保存: {demo_dir / '04_features.json'}")
print()

# ============================================================================
# 第 5 部分：演示流程脚本
# ============================================================================

print("[5/6] 生成演示流程脚本...")
print("-"*80)

demo_script = {
    "第1页 - 封面与痛点 (30秒)": {
        "标题": "告别碎片化：您的端侧智能工作中枢",
        "副标题": "锦衣卫多智能体知识系统",
        "讲稿": "评委好。当前知识工作者面临的核心痛点，是在十几个工具间切换，数据割裂，效率低下。我们带来的'锦衣卫'系统，旨在用一套运行在您本地电脑上的AI引擎，彻底终结这种碎片化。",
        "视觉": "左边：用户在多个软件间焦头烂额；右边：简洁的锦衣卫界面"
    },
    
    "第2页 - 解决方案总览 (30秒)": {
        "标题": "一体化的端侧智能工作流",
        "讲稿": "我们的解决方案是：在骁龙平台上，构建一个集成了数十个AI技能的多智能体系统。用户只需一个动作，背后多个AI智能体协同工作，输出最终成果。",
        "核心图示": "输入（混乱）→ 锦衣卫引擎（Snapdragon X Elite NPU）→ 输出（有序）"
    },
    
    "第3页 - 核心技术1：多智能体架构 (40秒)": {
        "标题": "像专业团队一样工作的AI：锦衣卫多智能体架构",
        "讲稿": "这是系统的'大脑'。它不是单一模型，而是一个分工明确的AI团队。例如，处理一份数据时：'通政司'调用技能做清洗，'监察院'调用技能做分析，'参谋司'调用技能生成建议，最终由'驿传司'合成报告。整个过程在端侧自动完成。",
        "图示": "7个智能体协同工作流程图"
    },
    
    "第4页 - 核心技术2：端侧异构计算 (40秒)": {
        "标题": "骁龙平台上的全栈优化：异构计算调度",
        "讲稿": "为实现复杂流程的端侧运行，我们进行了深度异构优化。轻量调度由CPU负责，重度的AI推理全部由骁龙Hexagon NPU承担。这不仅带来了性能提升，更关键的是实现了绝对的隐私安全，数据无需离开设备。",
        "图示": "CPU（指挥中心）+ NPU（重型计算）+ 数据100%本地流动"
    },
    
    "第5页 - 功能演示 (40秒)": {
        "标题": "从混乱到洞察，只需一步",
        "讲稿": "现在请看实际效果。用户只需拖入一份原始数据，系统将自动调用多个技能进行分析、思考，并直接输出一份结构化的商业报告。整个过程在您本地的笔记本电脑上完成。",
        "演示": "拖入Excel → 自动处理 → 30秒生成PPT报告"
    },
    
    "第6页 - 技术挑战与突破 (30秒)": {
        "标题": "攻克ARM端侧AI的'最后一公里'",
        "讲稿": "这背后，是我们攻克了在ARM架构上部署复杂AI栈的工程挑战。我们不仅让大模型跑起来，更让几十个AI技能像乐高一样在端侧精密组合，这本身就是一个重要突破。",
        "要点": "ARM64适配 + 30+技能集成 + 端侧复杂工作流"
    },
    
    "第7页 - 总结与优势 (20秒)": {
        "标题": "重新定义AI生产力工具",
        "讲稿": "因此，我们交付的不是一个功能，而是一个新范式：一个私密、高效、一体化的端侧智能工作平台。",
        "三大优势": "🛡️ 隐私主权 + ⚡ 效率跃升 + 🧩 开箱即用"
    },
    
    "第8页 - Q&A (10秒)": {
        "标题": "锦衣卫多智能体知识系统",
        "标语": "让复杂归于简单，让智能守护身边"
    }
}

print("✓ 演示流程脚本:")
for page, content in demo_script.items():
    print(f"  {page}")

# 保存演示脚本
with open(demo_dir / "05_demo_script.json", 'w', encoding='utf-8') as f:
    json.dump(demo_script, f, ensure_ascii=False, indent=2)

print(f"✓ 已保存: {demo_dir / '05_demo_script.json'}")
print()

# ============================================================================
# 第 6 部分：生成 PPT 内容文档
# ============================================================================

print("[6/6] 生成 PPT 内容文档...")
print("-"*80)

ppt_content = f"""# AntiNet 锦衣卫系统 - 3分钟演示 PPT 内容

## 第 1 页：封面与痛点 (30秒)

**标题**: 告别碎片化：您的端侧智能工作中枢  
**副标题**: 锦衣卫多智能体知识系统

**视觉设计**:
- 左侧：用户在多个软件图标间焦头烂额的漫画
- 右侧：简洁的"锦衣卫"系统界面，所有流程汇聚一处

**演讲稿**:
"评委好。当前知识工作者面临的核心痛点，是在十几个工具间切换，数据割裂，效率低下。我们带来的'锦衣卫'系统，旨在用一套运行在您本地电脑上的AI引擎，彻底终结这种碎片化。"

---

## 第 2 页：解决方案总览 (30秒)

**标题**: 一体化的端侧智能工作流

**核心图示**:
```
输入（混乱）          处理（核心）                    输出（有序）
文件、数据、网页  →  锦衣卫多智能体引擎  →  四色卡片、报告、洞察
                    (Snapdragon X Elite NPU)
```

**演讲稿**:
"我们的解决方案是：在骁龙平台上，构建一个集成了数十个AI技能的多智能体系统。用户只需一个动作，背后多个AI智能体协同工作，输出最终成果。"

---

## 第 3 页：核心技术1 - 多智能体架构 (40秒) ⭐

**标题**: 像专业团队一样工作的AI：锦衣卫多智能体架构

**架构图示**:
```
                    总指挥使 (Orchestrator)
                            |
        ┌───────────────────┼───────────────────┐
        |                   |                   |
    秘卷坊              通政司              监察院
  (知识管理)          (数据清洗)          (数据分析)
        |                   |                   |
    刑狱司              参谋司              太史阁
  (风险评估)          (策略建议)          (历史记录)
        |                   |                   |
        └───────────────────┼───────────────────┘
                            |
                    驿传司 (成果聚合)
```

**技能集成**:
- data-analysis-iteration (数据分析迭代)
- excel-office-pro (Excel 专业处理)
- pptx-generator (PPT 自动生成)
- 30+ 其他 AI 技能

**演讲稿**:
"这是系统的'大脑'。它不是单一模型，而是一个分工明确的AI团队。例如，处理一份数据时：'通政司'调用技能做清洗，'监察院'调用技能做分析，'参谋司'调用技能生成建议，最终由'驿传司'合成报告。整个过程在端侧自动完成。"

---

## 第 4 页：核心技术2 - 端侧异构计算 (40秒) ⭐

**标题**: 骁龙平台上的全栈优化：异构计算调度

**异构计算图示**:
```
┌─────────────────────────────────────────────┐
│  Qualcomm Snapdragon X Elite               │
│                                             │
│  ┌──────────┐        ┌──────────┐         │
│  │   CPU    │        │   NPU    │         │
│  │ 指挥中心  │───────▶│ 重型计算  │         │
│  │          │        │ Hexagon  │         │
│  │ • 任务调度│        │ • 7B模型 │         │
│  │ • API响应│        │ • 深度推理│         │
│  │ • 轻量逻辑│        │ • BURST模式│        │
│  └──────────┘        └──────────┘         │
│                                             │
│  数据流动: 100% 本地，零外泄               │
└─────────────────────────────────────────────┘
```

**性能数据**:
- 优化前: 1203ms (16 tokens)
- 优化后: 625ms (16 tokens)
- 性能提升: 49%

**演讲稿**:
"为实现复杂流程的端侧运行，我们进行了深度异构优化。轻量调度由CPU负责，重度的AI推理全部由骁龙Hexagon NPU承担。这不仅带来了性能提升，更关键的是实现了绝对的隐私安全，数据无需离开设备。"

---

## 第 5 页：功能演示 (40秒) ⭐⭐⭐

**标题**: 从混乱到洞察，只需一步

**演示流程** (视频/GIF):
1. 用户将一份销售数据 Excel 拖入系统
2. 系统自动开始处理（显示处理状态）
3. 30秒内，自动生成完整 PPT 报告：
   - 数据摘要
   - 趋势图表
   - 风险点高亮
   - 策略建议

**演讲稿**:
"现在请看实际效果。用户只需拖入一份原始数据，系统将自动调用多个技能进行分析、思考，并直接输出一份结构化的商业报告。整个过程在您本地的笔记本电脑上完成。"

---

## 第 6 页：技术挑战与突破 (30秒)

**标题**: 攻克ARM端侧AI的"最后一公里"

**挑战与突破**:
- ❌ 挑战: ARM64 (WoA) 生态适配、多技能端侧集成
- ✅ 突破: 完成 30+ 自研技能的本地化部署与协同调度
- 🎯 价值: 证明了在端侧实现复杂 AI 工作流的完全可行性

**演讲稿**:
"这背后，是我们攻克了在ARM架构上部署复杂AI栈的工程挑战。我们不仅让大模型跑起来，更让几十个AI技能像乐高一样在端侧精密组合，这本身就是一个重要突破。"

---

## 第 7 页：总结与优势 (20秒)

**标题**: 重新定义AI生产力工具

**三大核心优势**:

🛡️ **隐私主权**
- 数据永不出设备
- 100% 本地计算
- 零云端依赖

⚡ **效率跃升**
- 从小时级到分钟级
- 多智能体协同
- 自动化工作流

🧩 **开箱即用**
- 集成 30+ AI 能力
- 无需切换工具
- 一站式解决方案

**演讲稿**:
"因此，我们交付的不是一个功能，而是一个新范式：一个私密、高效、一体化的端侧智能工作平台。"

---

## 第 8 页：Q&A / 感谢 (10秒)

**标题**: 锦衣卫多智能体知识系统

**标语**: 让复杂归于简单，让智能守护身边

**联系方式**: [预留位置]

---

## 演示时间分配

| 页码 | 内容 | 时间 | 重点 |
|------|------|------|------|
| 1 | 封面与痛点 | 30秒 | 引入问题 |
| 2 | 解决方案总览 | 30秒 | 展示方案 |
| 3 | 多智能体架构 | 40秒 | ⭐ 技术亮点 |
| 4 | 异构计算 | 40秒 | ⭐ 技术亮点 |
| 5 | 功能演示 | 40秒 | ⭐⭐⭐ 王炸 |
| 6 | 技术挑战 | 30秒 | 突破价值 |
| 7 | 总结优势 | 20秒 | 价值升华 |
| 8 | Q&A | 10秒 | 结束 |
| **总计** | | **3分钟** | |

---

## 关键数据

### 系统架构
- **7个专业智能体**: 总指挥使、秘卷坊、通政司、监察院、刑狱司、参谋司、太史阁
- **30+ AI技能**: 数据分析、文档处理、AI推理、协同工作
- **4色知识卡片**: 红（重要紧急）、黄（重要不紧急）、蓝（不重要紧急）、绿（不重要不紧急）

### 性能指标
- **硬件平台**: Qualcomm Snapdragon X Elite
- **AI模型**: Qwen2.0-7B-SSD (7B参数)
- **推理性能**: 16 tokens @ 625ms
- **性能提升**: 49% (1203ms → 625ms)
- **性能模式**: BURST (最高性能)

### 技术突破
- ✅ ARM64 (WoA) 完整适配
- ✅ NPU 异构计算优化
- ✅ 30+ 技能端侧集成
- ✅ 多智能体任务编排
- ✅ 零数据外泄保障

---

## 视觉设计建议

### 配色方案
- **主色**: 深蓝色 (#1E3A8A) - 专业、可信
- **辅色**: 金色 (#F59E0B) - 锦衣卫元素
- **强调**: 红色 (#EF4444) - 重点标注
- **背景**: 白色/浅灰 - 简洁清晰

### 图标风格
- 使用扁平化、现代化图标
- 统一视觉语言
- 突出核心概念

### 动画效果
- 第5页演示: 使用流畅的GIF或视频
- 架构图: 适当的连线动画
- 数据展示: 渐进式呈现

---

## 演示技巧

1. **开场抓人**: 用痛点引发共鸣
2. **技术深度**: 第3-4页展示核心创新
3. **演示震撼**: 第5页是重中之重，必须流畅
4. **语言精炼**: 每页3-4句话，直击重点
5. **自信表达**: 用"我们攻克了"、"我们证明了"、"我们重新定义了"

---

## 备用问答

**Q: 为什么选择端侧而不是云端？**
A: 隐私安全、实时响应、零依赖。企业数据不能上云。

**Q: 性能能否满足实际需求？**
A: 16 tokens @ 625ms，快速问答场景完全满足。复杂分析可分批处理。

**Q: 如何保证多智能体协同的可靠性？**
A: 总指挥使统一调度，每个智能体独立容错，异常自动恢复。

**Q: 技术栈的可扩展性如何？**
A: 模块化设计，新技能即插即用，支持动态扩展。

---

**制作完成！祝演示成功！** 🎉
"""

# 保存 PPT 内容文档
with open(demo_dir / "06_ppt_content.md", 'w', encoding='utf-8') as f:
    f.write(ppt_content)

print(f"✓ 已保存: {demo_dir / '06_ppt_content.md'}")
print()

# ============================================================================
# 总结
# ============================================================================

print("="*80)
print("演示素材生成完成！")
print("="*80)
print()
print(f"所有素材已保存到: {demo_dir}")
print()
print("生成的文件:")
print("  1. 01_architecture.json    - 多智能体架构信息")
print("  2. 02_skills.json          - 技能系统信息")
print("  3. 03_npu_performance.json - NPU 性能数据")
print("  4. 04_features.json        - 功能特性列表")
print("  5. 05_demo_script.json     - 演示流程脚本")
print("  6. 06_ppt_content.md       - 完整 PPT 内容文档")
print()
print("="*80)
print("下一步:")
print("="*80)
print()
print("1. 查看 06_ppt_content.md 获取完整 PPT 内容")
print("2. 启动系统进行截图:")
print("   - 前端界面截图")
print("   - 多智能体工作流程")
print("   - 数据分析演示")
print("3. 使用 PowerPoint 制作 PPT")
print("4. 录制演示视频（第5页）")
print()
print("="*80)
